### 동기화

멀티스레드 환경에서는 여러 스레드가 공유 자원(예: 인스턴스 필드)에 동시에 접근할 때 동시성 문제가 발생할 수 있다. 
자바는 `synchronized` 키워드를 통해 아주 간단하게 임계 영역을 보호할 수 있다.


1. synchronized 사용

(1) 메서드 동기화

```java
public synchronized void synchronizedMethod() {
    // 코드
}
```

(2) 블록 동기화 
```java
public void method() {
    synchronized (this) {
        // 동기화된 코드
    }
}
```

- synchronized 가장 큰 장점이자 단점은 한 번에 하나의 스레드만 실행할 수 있다. 
- 여러 스레드가 동시에 실행하지 못하기 때문에, 전체로 보면 성능이 떨어질 수 있다. 
- 여러 스레드를 동시에 실행할 수 없는 코드 구간에만 한정해서 설정해야 한다. 

####  동작 방식
- 모든 객체(인스턴스)는 내부에 자신만의 락(lock)을 가지고 있다. (모니터 락) 
- 스레드가 synchronized 키워드가 있는 메서드에 진입하려면 락을 획득해야 한다. 
- 락을 획득한 후에 실행할 수 있다. (다른 쓰레드는 락을 획득할 때 까지 BLOCKED 상태로 대기, 락을 획득할 때 까지 무한정 대기) 
- BLOCKED 상태가 되면 락을 다시 획득하기 전까지는 계속 대기하고, CPU 실행 스케줄링에 들어가지 않는다 


#### 주의할점 
- 지역변수는 개별 스택에 쌓이므로 동시성 문제 x , 다른 스레드와 공유되지 않는다 
- 클래스 변수, 인스턴스 멤버 변수(필드), db 등은 동시성 문제 o   

